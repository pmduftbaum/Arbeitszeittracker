<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b0c" />
  <title>Arbeitszeittracker</title>
  <style>
    :root{
      --bg:#0b0b0c;--stroke:rgba(255,255,255,.1);--text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.62);--muted2:rgba(255,255,255,.44);
      --shadow:0 20px 60px rgba(0,0,0,.4);--r-xl:24px;--container:980px;--blur:18px
    }
    html{-webkit-text-size-adjust:100%}
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text";
      color:var(--text);background:var(--bg);position:relative}

    /* iOS scroll seam fix: render gradients on a fixed layer */
    body::before{content:"";position:fixed;inset:0;z-index:-1;pointer-events:none;
      background:
        radial-gradient(1200px 900px at 15% 10%,rgba(139,183,255,.22),transparent 55%),
        radial-gradient(900px 700px at 80% 15%,rgba(110,231,183,.12),transparent 55%),
        radial-gradient(1200px 900px at 55% 110%,rgba(251,113,133,.1),transparent 50%),
        var(--bg);
      transform:translateZ(0);
    }
    .wrap{max-width:var(--container);margin:0 auto;padding:36px 18px 64px}
    .topbar{position:sticky;top:0;z-index:20;padding:14px 0;backdrop-filter:blur(var(--blur))}
    .topbar-inner{display:flex;justify-content:space-between;align-items:center;gap:16px;padding:0 18px}
    .left{display:flex;align-items:center;gap:12px}
    .iconbtn{width:40px;height:40px;border-radius:16px;border:1px solid var(--stroke);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:38px;height:38px;border-radius:14px;background:rgba(255,255,255,.08);border:1px solid var(--stroke)}
    .brand h1{margin:0;font-size:18px;font-weight:650}
    .brand p{margin:2px 0 0;font-size:12px;color:var(--muted)}
    .right{display:flex;gap:10px}
    .pill{display:flex;flex-direction:column;align-items:flex-end}
    .pill .label{font-size:11px;color:var(--muted2)}
    .pill .value{padding:10px 12px;border-radius:999px;background:rgba(255,255,255,.07);border:1px solid var(--stroke);min-width:120px;text-align:center;font-weight:650}
    .hero{display:grid;gap:14px;padding:30px 0}
    .hero h2{margin:0;font-size:clamp(28px,5vw,44px);font-weight:720}
    .hero p{margin:0;color:var(--muted)}
    .btn{border-radius:999px;padding:12px 14px;border:1px solid var(--stroke);background:rgba(255,255,255,.07);color:var(--text);cursor:pointer}
    .btn.primary{background:linear-gradient(135deg,rgba(139,183,255,.26),rgba(255,255,255,.08))}
    .section{margin-top:22px;padding:18px;border-radius:var(--r-xl);background:rgba(255,255,255,.06);border:1px solid var(--stroke)}
    .days{display:grid;gap:14px}
    .month{padding:14px;border-radius:20px;border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.04)}
    .month-head{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:10px}
    .month-title .name{font-size:14px;font-weight:700}
    .month-title .sub{font-size:11px;color:var(--muted2)}
    .chip{padding:6px 10px;border-radius:999px;font-size:12px;border:1px solid rgba(255,255,255,.12)}
    .day{padding:14px;border-radius:16px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.06);display:grid;grid-template-columns:1fr auto;gap:12px}
    .day .meta{font-size:12px;color:var(--muted)}
    .badge{padding:6px 10px;border-radius:999px;font-size:12px;border:1px solid rgba(255,255,255,.12);text-align:center}
    dialog{border:none;border-radius:20px;background:rgba(20,20,22,.9);color:var(--text)}

    /* iOS input zoom fix: inputs >= 16px */
    input{font-size:16px}
  </style>
</head>
<body>
<header class="topbar">
  <div class="topbar-inner">
    <div class="left">
      <button class="iconbtn" id="btnSettings">⚙️</button>
      <div class="brand"><div class="logo"></div><div><h1>Arbeitszeittracker</h1><p id="subtitle">Minimal. Präzise. Unter Kontrolle.</p></div></div>
    </div>
    <div class="right">
      <div class="pill"><div class="label">Gesamt (netto)</div><div class="value" id="sumTime">0:00</div></div>
      <div class="pill"><div class="label">Gesamt (€)</div><div class="value" id="sumMoney">0,00 €</div></div>
    </div>
  </div>
</header>
<main class="wrap">
  <section class="hero"><h2>Arbeitszeit im Blick.</h2><p>Start–Ende, Pause, Monatsübersicht & Verdienst.</p><button class="btn primary" id="btnAdd">+ Neuer Tag</button></section>
  <section class="section"><div class="days" id="days"></div></section>
</main>

<dialog id="dlgSettings"><form method="dialog"><h3>Stundenlohn</h3><input id="hourly" placeholder="z.B. 18,50"><button id="saveSettings">Speichern</button></form></dialog>
<dialog id="dlgDay"><form method="dialog"><input id="start" placeholder="Start hh:mm"><input id="end" placeholder="Ende hh:mm"><input id="pause" placeholder="Pause hh:mm"><button id="saveDay">Speichern</button></form></dialog>

<script>
const DS='days.v3', SS='settings.v1';
const fmtE=new Intl.NumberFormat('de-DE',{style:'currency',currency:'EUR'});
const daysEl=document.getElementById('days'), sumT=document.getElementById('sumTime'), sumM=document.getElementById('sumMoney');
const loadDays=()=>JSON.parse(localStorage.getItem(DS)||'[]');
const saveDays=d=>localStorage.setItem(DS,JSON.stringify(d));
const loadRate=()=>JSON.parse(localStorage.getItem(SS)||'{"hourly":null}').hourly;
const saveRate=v=>localStorage.setItem(SS,JSON.stringify({hourly:v}));
const m2h=m=>m/60;
const fmtMin=m=>`${Math.floor(m/60)}:${String(m%60).padStart(2,'0')}`;
const parse=t=>{if(!t)return null;const [h,m]=t.replace('.',':').split(':').map(Number);if(isNaN(h)||isNaN(m))return null;return h*60+m};
function render(){const days=loadDays();const rate=loadRate();let total=0;daysEl.innerHTML='';const g={};days.forEach(d=>{const k=d.iso.slice(0,7);(g[k]=g[k]||[]).push(d)});
Object.keys(g).sort().reverse().forEach(k=>{const list=g[k];let msum=0;const box=document.createElement('div');box.className='month';const h=document.createElement('div');h.className='month-head';h.innerHTML=`<div class="month-title"><div class="name">${new Date(k+'-01').toLocaleDateString('de-DE',{month:'long',year:'numeric'})}</div><div class="sub">${list.length} Tage</div></div>`;const chip=document.createElement('div');chip.className='chip';h.appendChild(chip);box.appendChild(h);
list.forEach(d=>{let dur=d.end-d.start;if(dur<0)dur+=1440;const net=dur-d.pause;msum+=net;total+=net;const row=document.createElement('div');row.className='day';row.innerHTML=`<div><strong>${d.title}</strong><div class="meta">${fmtMin(d.start)}–${fmtMin(d.end)} · Pause ${fmtMin(d.pause)}</div></div><div><div class="badge">${fmtMin(net)}</div><div class="badge">${rate?fmtE.format(m2h(net)*rate):'€ —'}</div></div>`;box.appendChild(row)});
chip.textContent=`${fmtMin(msum)}`;daysEl.appendChild(box)});
sumT.textContent=fmtMin(total);sumM.textContent=rate?fmtE.format(m2h(total)*rate):'0,00 €'}

btnAdd.onclick=()=>dlgDay.showModal();
saveDay.onclick=()=>{const s=parse(start.value),e=parse(end.value),p=parse(pause.value)||0;if(s==null||e==null)return;const d=loadDays();d.push({iso:new Date().toISOString(),title:new Date().toLocaleDateString('de-DE',{weekday:'long',day:'2-digit',month:'2-digit',year:'numeric'}),start:s,end:e,pause:p});saveDays(d);dlgDay.close();render()}
btnSettings.onclick=()=>dlgSettings.showModal();
saveSettings.onclick=()=>{const v=Number(hourly.value.replace(',','.'));if(!isNaN(v))saveRate(v);dlgSettings.close();render()}
render();
</script>
</body>
</html>
